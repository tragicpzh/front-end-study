# BFF

## 简介

    Backends For Frontends(服务于前端的后端)，是指在服务器设计API时会考虑客户端使用情况。

## 出现的原因

    客户端需要与微服务交互，形成大致两类方案(api网关分发请求、CORS跨域请求)
        api网关分发请求：
            优点：
                封装了应用程序的内部结构，减少客户端与应用程序的交互次数，简化客户端代码处理
            缺点：
                1.增加了一个必须开发、部署和维护的高可用组件
                2.开发人员必须更新api网关
                3.需要准备粒度很细的api，这要求前后端频繁的沟通
        CORS跨域请求：
            优点：
                1.后端只需要提供粗粒度的api
            缺点：
                1.传输负载大
                2.前端需要负责一部分的模型层工作，即组织处理数据。
                3.多平台开发需要重复组织数据

## 作用

    1.提供一个中间层，来进行组装、聚合、裁剪数据。
    2.请求转发、数据转化、权鉴

## 优缺点

    优点：
        1.前后端彻底分离，即使后期有微服务迁移，也不需要改动前端代码
        2.业务更向前靠拢，细粒度的api由前端开发自己决定，更适配前端框架
        3.BFF可以自开mock、生成api文档，相比后端更方便
        4.留给后端更清晰的服务边界
        5.BFF是在内网调用微服务，可以使用RPC，来提高调用接口的性能。
    缺点：
        1.中间层转发增加了请求延迟
        2.需要保证端到端测试
        3.必须随时准备好后端异常准备
        4.增加开发成本

## nodeJS

    BFF本身可以使用各类语言实现(php,java...)
    优点：
        1.开发语言使用javascript,与前端开发人员的语言一致
        2.可以做mock
        3.同构更加方便，方便做SSR(服务端渲染)
        4.可以由前端控制接口的组合，减少前后端的冲突
    缺点：
        1.一个庞大的BFF层，需要前端开发人员掌握更多的技能(缓存、负载均衡、docker、日志收集...)
        2.需要严格的管控，防止其项目过大
        3.需要性能监控、弹性扩容、日志分析等基建

## SFF

    Serveless For Frontends 不需要服务器的前端
    1.在BFF的基础上，减少运维部分的工作
    2.缩短应用开发升级的时间
    3.前端开发人员只需关注Faas服务，不需要关注BFF层的配置、部署、管理问题
